{% extends "herobase/base.html" %}
{% block content %}
    {% include "herobase/quest/description.html" %}

    <h2>Dies ist deine Quest!</h2>
    {% if quest.cancelled %}
        Du hast diese Quest abgebrochen.
    {% else %}
        <form action="{% url adventure-update quest.id %}" method="post">
            {% csrf_token %}
            <h2>Allgemeine settings</h2>
            {% if 'cancel' in quest.get_owner_actions %}
                <input type="submit" name="action" class="btn btn-primary btn-large" value="cancel"/>
            {% endif %}
            {% if 'quest_done' in quest.get_owner_actions %}
                <input type="submit" name="action" class="btn btn-primary btn-large" value="quest_done"/>
            {% endif %}
        </form>
        <h2>    Die Folgenden Helden moechten dir helfen</h2>
        {% if quest.active_heroes.exists %}
            {% for adventure in quest.adventure_set.all %}
                <h3>{{ adventure.user }} (state: {{ adventure.get_state_display }})</h3>
                <form action="{% url adventure-update quest.id %}" method="post">
                    {% csrf_token %}
                        <input type="submit" name="action" class="btn btn-primary btn-large" value="cancel"/>
                    <input type="hidden" name="target_user" value="{{ adventure.user_id }}"/>

                    <input type="submit" name="action" class="btn btn-primary btn-large" value="hero_done"/>
                    <input type="submit" name="action" class="btn btn-primary btn-large" value="accept"/>
                </form>
            {% endfor %}
        {% else %}
            Leider hilft Dir noch niemand.
        {% endif %}

    {% endif %}
{%  endblock %}
